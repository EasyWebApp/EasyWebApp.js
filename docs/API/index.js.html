<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>index.js - Documentation</title>

    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="DataScope.html">DataScope</a></li><li><a href="HTMLView.html">HTMLView</a><ul class='methods'><li data-type='method'><a href="HTMLView.html#attach">attach</a></li><li data-type='method'><a href="HTMLView.html#childOf">childOf</a></li><li data-type='method'><a href="HTMLView.html#detach">detach</a></li><li data-type='method'><a href="HTMLView.html#emit">emit</a></li><li data-type='method'><a href="HTMLView.html#off">off</a></li><li data-type='method'><a href="HTMLView.html#on">on</a></li><li data-type='method'><a href="HTMLView.html#one">one</a></li><li data-type='method'><a href="HTMLView.html#parse">parse</a></li><li data-type='method'><a href="HTMLView.html#render">render</a></li><li data-type='method'><a href="HTMLView.html#scan">scan</a></li><li data-type='method'><a href="HTMLView.html#valueOf">valueOf</a></li><li data-type='method'><a href="HTMLView.html#watch">watch</a></li></ul></li><li><a href="InnerLink.html">InnerLink</a><ul class='methods'><li data-type='method'><a href="InnerLink.html#emit">emit</a></li><li data-type='method'><a href="InnerLink.html#off">off</a></li><li data-type='method'><a href="InnerLink.html#on">on</a></li><li data-type='method'><a href="InnerLink.html#one">one</a></li><li data-type='method'><a href="InnerLink.html#toString">toString</a></li><li data-type='method'><a href="InnerLink.html#valueOf">valueOf</a></li></ul></li><li><a href="ListView.html">ListView</a><ul class='methods'><li data-type='method'><a href="ListView.html#attach">attach</a></li><li data-type='method'><a href="ListView.html#childOf">childOf</a></li><li data-type='method'><a href="ListView.html#clear">clear</a></li><li data-type='method'><a href="ListView.html#detach">detach</a></li><li data-type='method'><a href="ListView.html#emit">emit</a></li><li data-type='method'><a href="ListView.html#indexOf">indexOf</a></li><li data-type='method'><a href="ListView.html#insert">insert</a></li><li data-type='method'><a href="ListView.html#off">off</a></li><li data-type='method'><a href="ListView.html#on">on</a></li><li data-type='method'><a href="ListView.html#one">one</a></li><li data-type='method'><a href="ListView.html#remove">remove</a></li><li data-type='method'><a href="ListView.html#render">render</a></li><li data-type='method'><a href="ListView.html#scan">scan</a></li><li data-type='method'><a href="ListView.html#sort">sort</a></li><li data-type='method'><a href="ListView.html#valueOf">valueOf</a></li><li data-type='method'><a href="ListView.html#watch">watch</a></li></ul></li><li><a href="Observer.html">Observer</a><ul class='methods'><li data-type='method'><a href="Observer.html#.extend">extend</a></li><li data-type='method'><a href="Observer.html#.instanceOf">instanceOf</a></li><li data-type='method'><a href="Observer.html#.registerEvent">registerEvent</a></li><li data-type='method'><a href="Observer.html#emit">emit</a></li><li data-type='method'><a href="Observer.html#off">off</a></li><li data-type='method'><a href="Observer.html#on">on</a></li><li data-type='method'><a href="Observer.html#one">one</a></li><li data-type='method'><a href="Observer.html#valueOf">valueOf</a></li></ul></li><li><a href="RenderNode.html">RenderNode</a><ul class='methods'><li data-type='method'><a href="RenderNode.html#toString">toString</a></li></ul></li><li><a href="TreeView.html">TreeView</a><ul class='methods'><li data-type='method'><a href="TreeView.html#.fromFlat">fromFlat</a></li><li data-type='method'><a href="TreeView.html#attach">attach</a></li><li data-type='method'><a href="TreeView.html#childOf">childOf</a></li><li data-type='method'><a href="TreeView.html#clear">clear</a></li><li data-type='method'><a href="TreeView.html#detach">detach</a></li><li data-type='method'><a href="TreeView.html#emit">emit</a></li><li data-type='method'><a href="TreeView.html#indexOf">indexOf</a></li><li data-type='method'><a href="TreeView.html#insert">insert</a></li><li data-type='method'><a href="TreeView.html#off">off</a></li><li data-type='method'><a href="TreeView.html#on">on</a></li><li data-type='method'><a href="TreeView.html#one">one</a></li><li data-type='method'><a href="TreeView.html#remove">remove</a></li><li data-type='method'><a href="TreeView.html#render">render</a></li><li data-type='method'><a href="TreeView.html#scan">scan</a></li><li data-type='method'><a href="TreeView.html#sort">sort</a></li><li data-type='method'><a href="TreeView.html#valueOf">valueOf</a></li><li data-type='method'><a href="TreeView.html#watch">watch</a></li></ul></li><li><a href="View.html">View</a><ul class='methods'><li data-type='method'><a href="View.html#.extend">extend</a></li><li data-type='method'><a href="View.html#attach">attach</a></li><li data-type='method'><a href="View.html#childOf">childOf</a></li><li data-type='method'><a href="View.html#detach">detach</a></li><li data-type='method'><a href="View.html#emit">emit</a></li><li data-type='method'><a href="View.html#off">off</a></li><li data-type='method'><a href="View.html#on">on</a></li><li data-type='method'><a href="View.html#one">one</a></li><li data-type='method'><a href="View.html#scan">scan</a></li><li data-type='method'><a href="View.html#valueOf">valueOf</a></li><li data-type='method'><a href="View.html#watch">watch</a></li></ul></li><li><a href="WebApp.html">WebApp</a><ul class='methods'><li data-type='method'><a href="WebApp.html#.component">component</a></li><li data-type='method'><a href="WebApp.html#emit">emit</a></li><li data-type='method'><a href="WebApp.html#getRoute">getRoute</a></li><li data-type='method'><a href="WebApp.html#load">load</a></li><li data-type='method'><a href="WebApp.html#loadPage">loadPage</a></li><li data-type='method'><a href="WebApp.html#off">off</a></li><li data-type='method'><a href="WebApp.html#on">on</a></li><li data-type='method'><a href="WebApp.html#one">one</a></li><li data-type='method'><a href="WebApp.html#setURLData">setURLData</a></li><li data-type='method'><a href="WebApp.html#valueOf">valueOf</a></li></ul></li></ul><h3>Modules</h3><ul><li><a href="module-WebApp.html">WebApp</a></li></ul><h3>Externals</h3><ul><li><a href="external-_jQuery.fn_.html">jQuery.fn</a><ul class='methods'><li data-type='method'><a href="external-_jQuery.fn_.html#.iWebApp">iWebApp</a></li><li data-type='method'><a href="external-_jQuery.fn_.html#.view">view</a></li></ul></li></ul><h3>Events</h3><ul><li><a href="HTMLView.html#event:attach">attach</a></li><li><a href="HTMLView.html#event:update">update</a></li><li><a href="ListView.html#event:attach">attach</a></li><li><a href="ListView.html#event:update">update</a></li><li><a href="TreeView.html#event:attach">attach</a></li><li><a href="TreeView.html#event:update">update</a></li><li><a href="View.html#event:attach">attach</a></li><li><a href="View.html#event:update">update</a></li><li><a href="WebApp.html#event:data">data</a></li><li><a href="WebApp.html#event:ready">ready</a></li><li><a href="WebApp.html#event:request">request</a></li><li><a href="WebApp.html#event:route">route</a></li><li><a href="WebApp.html#event:template">template</a></li></ul><h3>Global</h3><ul><li><a href="global.html#require">require</a></li></ul>
</nav>

<div id="main">

    <h1 class="page-title">index.js</h1>

    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * EasyWebApp.js - A Light-weight SPA Engine based on jQuery Compatible API
 *
 * @module    {function} WebApp
 *
 * @version   4.0 (2017-12-22) stable
 *
 * @requires  jquery
 * @see       {@link http://jquery.com/ jQuery}
 * @requires  jQueryKit
 * @see       {@link https://techquery.github.io/iQuery.js iQuery}
 *
 * @copyright TechQuery &lt;shiy2008@gmail.com> 2015-2017
 */

define(['jquery', './WebApp', './InnerLink'],  function ($, WebApp, InnerLink) {

    /**
     * 承诺对象
     *
     * @typedef {Promise} Promise
     *
     * @see     {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Promise|Promise}
     */

    /**
     * URL 对象
     *
     * @typedef {URL} URL
     *
     * @see     {@link https://developer.mozilla.org/en-US/docs/Web/API/URL|URL}
     */

    /**
     * DOM 树节点抽象类
     *
     * @typedef {Node} Node
     *
     * @see     {@link https://developer.mozilla.org/en-US/docs/Web/API/Node|Node}
     */

    /**
     * HTML 元素标签抽象类
     *
     * @typedef {HTMLElement} HTMLElement
     *
     * @see     {@link https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement|HTMLElement}
     */

/* ---------- AMD based Component API ---------- */

    var _require_ = self.require,  _script_;

    /**
     * 增强的 require()
     *
     * @global
     * @function require
     *
     * @param {string[]} dependency
     * @param {function} [factory]
     * @param {function} [fallback]
     *
     * @return {Promise}
     *
     * @see {@link https://github.com/amdjs/amdjs-api/wiki/require#requirearray-function-}
     */

    self.require = $.extend(function (dependency, factory, fallback) {

        var script = document.currentScript;

        return  new Promise(function (resolve, reject) {

            var parameter = [
                    dependency,
                    (factory instanceof Function)  ?  factory  :  resolve,
                    (fallback instanceof Function)  ?  fallback  :  reject
                ];

            if (! script)  return _require_.apply(null, parameter);

            _require_.call(this,  parameter[0],  function () {

                _script_ = script;

                return  parameter[1].apply(this, arguments);

            },  parameter[2]);
        });
    },  _require_);

    /**
     * 组件工厂声明
     *
     * @author    TechQuery
     *
     * @memberof  WebApp
     *
     * @param     {function}  factory - The factory function of current
     *                                  component &amp; its data
     * @returns   {function}  WebApp constructor
     */

    WebApp.component = function (factory) {

        var iWebApp = new this(), view = this.View.instanceOf(_script_);

        var link = (view.$_View[0] === iWebApp.$_View[0])  ?
                iWebApp[ iWebApp.lastPage ]  :
                InnerLink.instanceOf( view.$_View );

        if ( link )  link.emit('load', factory);

        return this;
    };

    $.extend(WebApp.prototype, {
        /**
         * 更新路由 URI 的参数数据
         *
         * @author    TechQuery
         *
         * @memberof  WebApp.prototype
         *
         * @param     {string|object}          key      String or
         *                                              Key-Value Object
         * @param     {number|boolean|string}  [value]
         * @returns   {WebApp}
         */
        setURLData:    function (key, value) {

            var URL = this.getRoute().split(/&amp;?data=/);

            if (typeof key === 'string') {

                var name = key;  key = { };

                key[ name ] = value;
            }

            if (!  $.isEqual(key,  $.intersect(key, $.paramJSON( URL[0] ))))
                self.history.pushState(
                    {
                        index:    this.lastPage,
                        data:     key
                    },
                    document.title,
                    '#!' + self.btoa(
                        $.extendURL(URL[0], key)  +  (
                            URL[1]  ?  ('&amp;data=' + URL[1])  :  ''
                        )
                    )
                );

            return this;
        }
    });

/* ---------- jQuery based Helper API ---------- */

    /**
     * jQuery 对象
     *
     * @typedef {jQuery} jQuery
     *
     * @see     {@link https://api.jquery.com/jQuery|jQuery}
     */

    /**
     * jQuery 构造函数 第一参数接受的数据类型
     *
     * @typedef {(string|HTMLElement|HTMLElement[]|jQuery)} jQueryAcceptable
     *
     * @see     {@link https://api.jquery.com/jQuery|jQuery Acceptable}
     */

    /**
     * jQuery 插件命名空间
     *
     * @external "jQuery.fn"
     *
     * @see      {@link http://learn.jquery.com/plugins/|jQuery Plugins}
     */

    /**
     * 在 jQuery 对象首个元素上创建/获取视图对象
     *
     * @author    TechQuery
     *
     * @function  external:"jQuery.fn".view
     *
     * @param     {string}  [Class_Name] - String for creating,
     *                                     or empty for getting
     * @returns   {View}
     */

    $.fn.view = function (Class_Name) {

        if (! this[0])  return;

        return  Class_Name  ?
            (new WebApp[Class_Name](this[0], arguments[1]))  :
            WebApp.View.instanceOf(this[0], false);
    };

    /**
     * 在 jQuery 对象首个元素上创建/获取 Web 应用对象
     *
     * @author   TechQuery
     *
     * @function external:"jQuery.fn".iWebApp
     *
     * @param    {(string|URL)}  [API_Root] - The Root Path of Back-end API
     *                                        formatted as Absolute URL
     * @returns  {WebApp}
     */

    return  $.fn.iWebApp = WebApp;

});
</code></pre>
        </article>
    </section>

</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/linenumber.js"></script>
</body>
</html>
