<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: view/ListView.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: view/ListView.js</h1>






    <section>
        <article>
            <pre class="prettyprint source linenums"><code>define([
    'jquery', './View', './HTMLView', '../InnerLink'
],  function ($, View, HTMLView, InnerLink) {

    /**
     * 迭代视图类（对应 JSON 数组）
     *
     * @description 默认匹配：设置了 `data-name` 属性的 `ul, ol, tbody, select, datalist` 元素
     *
     * @author  TechQuery
     *
     * @class   ListView
     * @extends View
     *
     * @param   {jQueryAcceptable} $_View  - Container DOM of ListView
     * @param   {object}           [scope] - Data object as a scope
     *
     * @returns {ListView}         Return the last one if a ListView instance
     *                             has been created on this element
     */

    function ListView($_View, scope) {

        var _This_ = View.call(this, $_View, scope);

        if (_This_ !== this)  return _This_;

        this.setPrivate({
            HTML:     this.$_View.html(),
            parse:    $.now()
        }).clear();
    }

    View.extend(ListView, {
        is:    $.expr[':'].list
    }, {
        splice:     Array.prototype.splice,
        /**
         * 清空视图
         *
         * @author   TechQuery
         *
         * @memberof ListView.prototype
         *
         * @returns  {ListView} Current ListView
         */
        clear:      function () {

            this.$_View.empty();

            this.splice(0, Infinity);

            return this;
        },
        /**
         * 插入一项
         *
         * @author   TechQuery
         *
         * @memberof ListView.prototype
         *
         * @param    {object}   data      - Data of one Item
         * @param    {number}   [index=0] - Index of Insert Point
         * @param    {boolean}  [delay]   - Create one HTMLView, and not insert
         *
         * @returns  {HTMLView} Newly created Item
         */
        insert:     function (data, index, delay) {

            var Item = (new HTMLView(this.__HTML__, this.__data__)).parse();

            Item.$_View.find( InnerLink.HTML_Link ).addBack( InnerLink.HTML_Link )
                .each(function () {

                    new InnerLink( this );
                });

            data.__index__ = index = index || 0;

            this.splice(index,  0,  Item.render( data ));

            this.__data__.splice(index,  0,  Item.__data__);

            if (! delay)  Item.$_View.insertTo(this.$_View, index);

            return Item;
        },
        /**
         * 渲染视图
         *
         * @author   TechQuery
         *
         * @memberof ListView.prototype
         *
         * @param    {object[]} list    - ArrayLike Object of Data Object
         * @param    {number}   [index] - Insert offset
         *
         * @returns  {ListView} Current ListView
         */
        render:     function (list, index) {

            if (! (index != null))  this.clear();

            index = index || 0;

            if ($.likeArray( list ))
                $(Array.from(list,  function (data, i) {

                    return  this.insert(data, index + i, true).$_View[0];

                },  this)).insertTo(this.$_View, index);

            return this;
        },
        /**
         * 根据 HTML 节点查询索引
         *
         * @author   TechQuery
         *
         * @memberof ListView.prototype
         *
         * @param    {jQueryAcceptable} $_Item - An HTMLElement in one of the List
         *
         * @returns  {number}           Index of $_Item
         */
        indexOf:    function ($_Item) {

            $_Item = ($_Item instanceof $)  ?  $_Item  :  $( $_Item );

            return (
                ($_Item[0].parentNode == this.$_View[0])  ?
                    $_Item  :  $_Item.parentsUntil( this.$_View )
            ).slice( -1 ).index();
        },
        /**
         * 删除一项
         *
         * @author   TechQuery
         *
         * @memberof ListView.prototype
         *
         * @param    {number}   index - Index of Remove Point
         *
         * @returns  {HTMLView} Newly removed Item
         */
        remove:     function (index) {

            var Item = this.splice(
                    $.isNumeric( index )  ?  index  :  this.indexOf( index ),  1
                )[0];

            Item.$_View.remove();

            return Item;
        },
        /**
         * 列表排序
         *
         * @author   TechQuery
         *
         * @memberof ListView.prototype
         *
         * @param    {function} callback - Same as the callback of
         *                                 Array.prototype.sort()
         *
         * @returns  {ListView} Current ListView
         */
        sort:       function (callback) {

            Array.prototype.sort.call(this, callback);

            this.$_View.append($.map(this,  function (Item) {

                Item.__index__ = arguments[1];

                return Item.$_View[0];
            }));

            return this;
        }
    });

    return ListView;

});</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-WebApp.html">WebApp</a></li></ul><h3>Externals</h3><ul><li><a href="external-_jQuery.fn_.html">jQuery.fn</a></li></ul><h3>Classes</h3><ul><li><a href="DataScope.html">DataScope</a></li><li><a href="HTMLView.html">HTMLView</a></li><li><a href="InnerLink.html">InnerLink</a></li><li><a href="ListView.html">ListView</a></li><li><a href="Observer.html">Observer</a></li><li><a href="RenderNode.html">RenderNode</a></li><li><a href="TreeView.html">TreeView</a></li><li><a href="View.html">View</a></li><li><a href="WebApp.html">WebApp</a></li></ul><h3>Events</h3><ul><li><a href="HTMLView.html#event:attach">attach</a></li><li><a href="HTMLView.html#event:update">update</a></li><li><a href="ListView.html#event:attach">attach</a></li><li><a href="ListView.html#event:update">update</a></li><li><a href="TreeView.html#event:attach">attach</a></li><li><a href="TreeView.html#event:update">update</a></li><li><a href="View.html#event:attach">attach</a></li><li><a href="View.html#event:update">update</a></li><li><a href="WebApp.html#event:data">data</a></li><li><a href="WebApp.html#event:ready">ready</a></li><li><a href="WebApp.html#event:request">request</a></li><li><a href="WebApp.html#event:route">route</a></li><li><a href="WebApp.html#event:template">template</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Sat Oct 21 2017 06:48:34 GMT+0800 (中国标准时间)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
